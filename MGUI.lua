local TweenService = game:GetService('TweenService')
local UserInputService = game:GetService('UserInputService')

local UI = {
	Utils = {},
	Theme = {
		WindowBackgroundColor = Color3.fromRGB(35, 34, 45),
		WindowBackgroundColorDark = Color3.fromRGB(30, 28, 39),
		ButtonBackgroundColor = Color3.fromRGB(34, 32, 44),
		TextColor = Color3.fromRGB(225, 0, 0)
	}
}

function UI:NewWindow(WindowOptions)
	local ScreenGUI = Instance.new("ScreenGui")
	ScreenGUI.Name = "URMOM"
	ScreenGUI.Parent = game.CoreGui
	ScreenGUI.ResetOnSpawn = false
	
	local MainUIContainer = Instance.new("Frame")
	MainUIContainer.Name = "MainUIContainer"
	MainUIContainer.Parent = ScreenGUI
	MainUIContainer.Size = UDim2.new(0, 600, 0, 350)
	MainUIContainer.BackgroundTransparency = 0.100
	MainUIContainer.BackgroundColor3 = UI.Theme.WindowBackgroundColor
	
	local ActionBar = Instance.new("Frame")
	ActionBar.Name = "ActionBar"
	ActionBar.Parent = MainUIContainer
	ActionBar.Size = UDim2.new(0, MainUIContainer.Size.X, 0, 20)
	ActionBar.BackgroundColor3 = UI.Theme.WindowBackgroundColorDark
	
	local WindowName = Instance.new("TextLabel")
	WindowName.Name = "WindowName"
	WindowName.Text = WindowOptions.Name
	WindowName.TextColor3 = UI.Theme.TextColor
	
	local DestroyUIButton = Instance.new("ImageButton")
	DestroyUIButton.Name = "DestroyUIButton"
	DestroyUIButton.Parent = ActionBar
	DestroyUIButton.Size = UDim2.new(0, 18, 0, 18)
	DestroyUIButton.BackgroundColor3 = UI.Theme.ButtonBackgroundColor
	
	UI.Utils:MakeDragable(ActionBar, MainUIContainer)
end

function UI.Utils:MakeDragable(UI_Top, UI_Main)
	local IsDragging, DragInput, DragStart, StartPosition = nil
	
	local function Update(UserInput)
		local Delta = UserInput.Position - DragStart
		local CalculatedPos = UDim2.new(
			StartPosition.X.Scale,
			StartPosition.X.Offset + Delta.X,
			StartPosition.Y.Scale,
			StartPosition.Y.Offset + Delta.Y
		)
		
		local MoveAnimTween = TweenService:Create(UI_Main, TweenInfo.new(0.2), {Position = CalculatedPos})
		MoveAnimTween:Play()
	end
		    
	UI_Top.InputBegan:Connect(function(UserInput)
		if UserInput.UserInputType == Enum.UserInputType.MouseButton1 or UserInput.UserInputType == Enum.UserInputType.Touch then
			IsDragging = true
			DragStart = UserInput.Position
			StartPosition = UI_Main.Position
		    
			UserInput.Changed:Connect(function()
				if UserInput.UserInputState == Enum.UserInputState.End then
					IsDragging = false
				end
			end)
		end
	end)
	
	UI_Top.InputChanged:Connect(function(UserInput)
		if UserInput.UserInputType == Enum.UserInputType.MouseMovement or 
			UserInput.UserInputType == Enum.UserInputType.Touch
		then
			DragInput = UserInput
		end
	end)
    
	UserInputService.InputChanged:Connect(function(UserInput)
		if UserInput == DragInput and IsDragging then
			Update(UserInput)
		end
	end)
end

return UI
